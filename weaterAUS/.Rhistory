print(tempHumi)
tempHumi <- ggplot(AlburyWeather, aes(x = Temp3pm, y = Humidity3pm, color = Year)) +
geom_point(size = 3) +  # Noktaları gösterir
geom_smooth(method = "lm", color = "black", linetype = "dashed") +  # Regresyon doğrusunu ekler
labs(
x = "Sicaklik (Saat 3)",
y = "Nem Orani",
title = "Sicaklik/Nem Karsilastirmasi"
) +
theme_minimal()  # Temayı sadeleştirir
print(tempHumi)
library(caret)
AlburyWeather %>% group_by(YearMonth) %>% summarise(dw.test(Temp3pm)$p.value)
library(BSDA)
library(car)
AlburyWeather %>% group_by(YearMonth) %>% summarise(durbinWatsonTest(Temp3pm)$p.value)
AlburyWeather %>% group_by(YearMonth) %>% summarise(durbinWatsonTest(lm(Temp3pm~YearMonth))$p.value)
AlburyWeather %>% group_by(YearMonth) %>% summarise(leveneTest(Temp3pm)$p.value)
AlburyWeather %>% group_by(YearMonth) %>% summarise(leveneTest(Temp3pm,group = YearMonth)$p.value)
AlburyWeather %>% group_by(YearMonth) %>% summarise(leveneTest(Temp3pm~YearMonth)$p.value)
AlburyWeather %>% group_by(YearMonth) %>% summarise(bartlett.test(Temp3pm~YearMonth)$p.value)
bartlett.test(AlburyWeather$Temp3pm~AlburyWeather$YearMonth)
durbinWatsonTest(AlburyWeather$Temp3pm~AlburyWeather$YearMonth)
durbinWatsonTest(lm(AlburyWeather$Temp3pm~AlburyWeather$YearMonth))
AlburyWeather$Temp3pm[AlburyWeather$Year==2008]
View(AlburyWeather)
t.test(AlburyWeather$Temp3pm[AlburyWeather$Year==2009],mu = )
AlburyWeather$Temp3pm[AlburyWeather$Year==2009]
t.test(AlburyWeather$Temp3pm[AlburyWeather$Year==2009],mu = 20,alternative = "two.sided",conf.level = 0.95)
t.test(AlburyWeather$Temp3pm[AlburyWeather$Year==2009],mu = 20,alternative = "two.sided",conf.level = 0.95)
t.test(AlburyWeather$Temp3pm[AlburyWeather$Year==2009],mu = 20,alternative = "two.sided",conf.level = 0.95)
# H0: 2009 yilindaki hava sicakliklarinin ortalama degeri 20'dir
# Ha: 2009 yilindaki hava sicakliklarinin ortalama degeri 20 degildir
# yillara gore sicaklik degerlerinin ortalamasini karsilastirmak icin onden bir alistirma yaptik
# verilerimiz normallik gosterdigi icin t.test kullandik ancak iki degiskenli istatistik analizi icin
# varyans homojenliklerini de kontrol etmemiz gerekecek.
# p degerigimiz 0.05den kucuk geldigi icin %95 dogruluk oraninda 2009 yilina ait saat 3 sicaklik degerimizin ortalama degeri
# 20'ye esit degildir diyoruz.
View(AlburyWeather)
bartlett.test(Temp3pm~Year, data = AlburyWeather)
bartlett.test(Temp3pm~YearMonth, data = AlburyWeather)
bartlett.test(Temp3pm~Month, data = AlburyWeather)
bartlett.test(Temp3pm~YearMonth, data = AlburyWeather)
bartlett.test(Temp3pm~Year, data = AlburyWeather)
bartlett.test(Temp3pm~Year, data = AlburyWeather[Year=c(2009,2010)])
bartlett.test(Temp3pm~Year, data = AlburyWeather[Year==c(2009,2010)])
bartlett.test(Temp3pm~Year, data = AlburyWeather[AlburyWeather$Year==c(2009,2010)])
AlburyWeather[AlburyWeather$Year==c(2009,2010)]
View(AlburyWeather)
bartlett.test(Temp3pm~Year, data = AlburyWeather[AlburyWeather$Year==c("2009","2010")])
AlburyWeather[AlburyWeather$Year==2009]
AlburyWeather[,AlburyWeather$Year==2009]
AlburyWeather[AlburyWeather$Year==2009,]
bartlett.test(Temp3pm~Year, data = AlburyWeather[AlburyWeather$Year==c("2009","2010")],)
bartlett.test(Temp3pm~Year, data = AlburyWeather[AlburyWeather$Year==c(2009,2010)],)
bartlett.test(Temp3pm~Year, data = AlburyWeather[AlburyWeather$Year==c(2009,2010),])
AlburyWeather[AlburyWeather$Year==2009,]
yil9 <- AlburyWeather[AlburyWeather$Year==2009,]
yil10 <- AlburyWeather[AlburyWeather$Year==2010,]
t.test(x = yil9 ,y = yil10, alternative = "two.sided")
t.test(x = yil9$Temp3pm ,y = yil10$Temp3pm, alternative = "two.sided")
yil11 <- AlburyWeather[AlburyWeather$Year==2011,]
yil12 <- AlburyWeather[AlburyWeather$Year==2012,]
bartlett.test(Temp3pm~Year, data = AlburyWeather[AlburyWeather$Year==c(2010,2011),])
bartlett.test(Temp3pm~Year, data = AlburyWeather[AlburyWeather$Year==c(2011,2012),])
t.test(x = yil11$Temp3pm, y = yil12$Temp3pm, alternative = "two.sided",var.equal = T)
t.test(x = yil11$Temp3pm, y = yil12$Temp3pm, alternative = "two.sided",var.equal = F)
t.test(x = yil11$Temp3pm, y = yil12$Temp3pm, alternative = "two.sided")
anova_result <- aov(Temp3pm ~ Year, data = AlburyWeather)
summary(anova_result)
TukeyHSD(anova_result)
# elimizdeki 2008 veri sayisi az oldugundan anova testi oncesi onu cikaralim
AlburyWeather[AlburyWeather$Year==2008,]
# elimizdeki 2008 veri sayisi az oldugundan anova testi oncesi onu cikaralim
AlburyWeather[-AlburyWeather$Year==2008,]
# elimizdeki 2008 veri sayisi az oldugundan anova testi oncesi onu cikaralim
AlburyWeather[AlburyWeather$Year==2008,]
# elimizdeki 2008 veri sayisi az oldugundan anova testi oncesi onu cikaralim
which(AlburyWeather[AlburyWeather$Year==2008,])
# elimizdeki 2008 veri sayisi az oldugundan anova testi oncesi onu cikaralim
AlburyWeather["Year"==2008,]
# elimizdeki 2008 veri sayisi az oldugundan anova testi oncesi onu cikaralim
AlburyWeather["Year"==2008,]
# elimizdeki 2008 veri sayisi az oldugundan anova testi oncesi onu cikaralim
AlburyWeather[2008,]
# elimizdeki 2008 veri sayisi az oldugundan anova testi oncesi onu cikaralim
library(tidyverse)
AlburyWeather %>% filter(Year!=2008)
alb <- AlburyWeather %>% filter(Year!=2008)
anova_result <- aov(Temp3pm ~ Year, data = alb)
summary(anova_result)
TukeyHSD(anova_result)
t.test(x = yil12$Temp3pm, y = yil11$Temp3pm, alternative = "two.sided")
t.test(x = yil11$Temp3pm, y = yil12$Temp3pm, alternative = "two.sided")
AlburyWeather
head(AlburyWeather)
# makina ogrenmesi modeli olusturmak icin hani degiskenleri kullanmam gerektigi konusunda ufak goz gezdirmeler yapiyorum
library(tidyverse)
dataModel <- AlburyWeather %>% select(Temp3pm,MinTemp,MaxTemp,Rainfall,WindSpeed3pm,Humidity3pm)
# bu verileri kullanmaya karar verdim. bu verileri kullanmama karar vermemde yukarida grafigini cizdigim kolerasyon istatistigi yardimci oldu
head(dataModel)
set.seed(125)
ind <- sample(1:nrow(dataModel), size = nrow(dataModel)*0.75)
AlburyWeather[ind,]
# verilerimin %75'ini modelimi egitmek icin %25'ini modelimi test etmek icin kullanacagim
trainSet <- AlburyWeather[ind,]
testSet <- AlburyWeather[-ind,]
# Linear Model
modelLM <- lm(Temp3pm ~ . , data = trainSet)
summary(modelLM)
# verilerimin %75'ini modelimi egitmek icin %25'ini modelimi test etmek icin kullanacagim
trainSet <- dataModel[ind,]
set.seed(125)
ind <- sample(1:nrow(dataModel), size = nrow(dataModel)*0.75)
# verilerimin %75'ini modelimi egitmek icin %25'ini modelimi test etmek icin kullanacagim
trainSet <- dataModel[ind,]
testSet <- dataModel[-ind,]
# Linear Model
modelLM <- lm(Temp3pm ~ . , data = trainSet)
summary(modelLM)
## tahmin islemini gerceklestirelim
tahminLM <- predict(modelLM,testSet)
tahminLM
head(tahminLM)
# modelimizi degerlendirelim
library(caret)
R2(tahminLM,testSet$Temp3pm)
RMSE(tahminLM,testSet$Temp3pm)
MAE(tahminLM,testSet$Temp3pm)
library(earth)
modelMARS <- earth(Temp3am ~ . , data = trainSet, penalty = 2, degree=2, nk=200,
nfold=10, keepxy=T)
modelMARS <- earth(Temp3pm ~ . , data = trainSet, penalty = 2, degree=2, nk=200,
nfold=10, keepxy=T)
summary(modelMARS)
# bu verileri kullanmaya karar verdim. bu verileri kullanmama karar vermemde yukarida grafigini cizdigim kolerasyon istatistigi yardimci oldu
head(dataModel)
summary(modelLM)
head(tahminLM)
R2(tahminLM,testSet$Temp3pm)
RMSE(tahminLM,testSet$Temp3pm)
MAE(tahminLM,testSet$Temp3pm)
summary(modelMARS)
tahminMARS <- predict(modelMARS,testSet)
tahminMARS
head(tahminMARS)
# modelimizi degerlendirelim
library(caret)
R2(tahminMARS,testSet$Temp3pm)
RMSE(tahminMARS,testSet$Temp3pm)
MAE(tahminMARS,testSet$Temp3pm)
AlburyWeather
md.pattern(AlburyWeather)
# Eksik veri kontrolu yapalim
library(mice)
# Eksik veri kontrolu yapalim
library(mice)
md.pattern(AlburyWeather)
AlburyWeather[-index,]
head(AlburyWeather)
print(havadurumu)
plot(y=AlburyWeather$Temp3pm,x=AlburyWeather$Year, main =  "Tarihlere Gore Hava Durumu",
ylab = "Hava Sicakligi(Saat 3)",xlab = "Tarih",col = AlburyWeather$Color, pch = 19)
print(MinMaxTemp)
plot(AlburyWeather$Temp3pm~AlburyWeather$Rainfall,col = AlburyWeather$Color, pch = 19,
xlab = "Rainfall", ylab = "Sicaklik (saat3)", main ="Sicaklik Karsilastirma Grafigi")
plot(rainVStemp3$MinTemp~rainVStemp3$Rainfall,col = AlburyWeather$Color, pch = 19,
xlab = "Rainfall", ylab = "Sicaklik (saat3)", main ="Sicaklik/Yagis Miktari Grafigi")
print(tempHumi)
# her bir ayın saat 3 oldugundaki sicaklik degerlerinin dagilisini kontrol edelim
AlburyWeather %>% group_by(YearMonth) %>% summarise(shapiro.test(Temp3pm)$p.value)
library(tidyverse)
# her bir ayın saat 3 oldugundaki sicaklik degerlerinin dagilisini kontrol edelim
AlburyWeather %>% group_by(YearMonth) %>% summarise(shapiro.test(Temp3pm)$p.value)
t.test(AlburyWeather$Temp3pm[AlburyWeather$Year==2009],mu = 20,alternative = "two.sided",conf.level = 0.95)
# H0: 2009 yilindaki hava sicakliklarinin ortalama degeri 20'dir
# Ha: 2009 yilindaki hava sicakliklarinin ortalama degeri 20 degildir
# yillara gore sicaklik degerlerinin ortalamasini karsilastirmak icin onden bir alistirma yaptik
# verilerimiz normallik gosterdigi icin t.test kullandik ancak iki degiskenli istatistik analizi icin
# varyans homojenliklerini de kontrol etmemiz gerekecek.
# p degerigimiz 0.05den kucuk geldigi icin %95 dogruluk oraninda 2009 yilina ait saat 3 sicaklik degerimizin ortalama degeri
# 20'ye esit degildir diyoruz.
read.csv("/weaterAUS.csv")
# dplyr paketini aktif hale getirelim
library(tidyverse)
# Sadece tek bir konum icin analiz yapalim
AlburyWeather <- weatherAUS %>% filter(Location=="Albury")
View(AlburyWeather)
# Analiz ve tahmin icin gerekli verilerimizi seciyoruz
AlburyWeather <- AlburyWeather %>% select(Temp3pm,MinTemp,MaxTemp,Rainfall,WindSpeed3pm,Humidity3pm,Pressure3pm,Date)
AlburyWeather
# Eksik veri kontrolu yapalim
library(mice)
md.pattern(AlburyWeather)
# Toplam 46 degerim NA geldi. 3011 veri icerisinde az oldugundan dolayi bunlari atabiliriz
which(is.na(AlburyWeather))
# NA olarak atanmis verilerimin Index numaralarina goz attim
# Iki sekilde bu gozlemlerden kurtulabiliriz
#Birinci Yontem
index <- which(is.na(AlburyWeather))
AlburyWeather[-index,]
# Ikinci Yontem
na.omit(AlburyWeather)
# Bu yontemi kullanarak NA iceren tum satiri atiyoruz. Bu yontemi kullanalim
AlburyWeather <- na.omit(AlburyWeather)
head(AlburyWeather)
AlburyWeather$Year <- format(as.Date(AlburyWeather$Date, format="%Y-%m-%d"), "%Y")
# Veri setimizdeki tarih bolumune ek olarak Yil bolumu olusturduk
years <- unique(AlburyWeather$Year)
# Her bir yili tekil olarak ayarladik
colors <- rainbow(length(years))
# Her tekil yila renk atamasi yaptik
AlburyWeather$Color <- colors[as.factor(AlburyWeather$Year)]
# faktorlere gore renk atamasi yaptik
AlburyWeather$Date <- as.Date(AlburyWeather$Date, format="%Y-%m-%d")
# tarih degiskenimi date'e donusturme islemini gerceklestirdim
havadurumu <- ggplot(AlburyWeather, aes(x = Date, y = Temp3pm, color = Year)) +
geom_point(size = 3) +
labs(
title = "Tarihlere Gore Hava Durumu",
x = "Tarih",
y = "Hava Sicakligi (Saat 3)"
) + theme_minimal() +
theme(
legend.title = element_blank(),
legend.text = element_text(size = 8),
legend.key.size = unit(0.5, "cm")
)
print(havadurumu)
# Grafigimizi olusturduk.
# yillara gore renklendirilmis sekilde sicaklik degerlerimizi bu sekilde inceliyoruz
plot(y=AlburyWeather$Temp3pm,x=AlburyWeather$Year, main =  "Tarihlere Gore Hava Durumu",
ylab = "Hava Sicakligi(Saat 3)",xlab = "Tarih",col = AlburyWeather$Color, pch = 19)
# verilerimizin yillara gore sicaklik aralşklarini incelemek icin Year degiskenimizle bir plot cizdirdik
library(GGally)
# Albury sehrine ait verileri aciklayici olarak gorsellestiren bir fonksiyonumuz:
ggpairs(AlburyWeather,columns = 1:7)
# Corr degerlerimiz aralarindaki baglanti boyutunu ve yonunu belirliyor.
MinMaxTemp <- ggplot(AlburyWeather, aes(x = MinTemp, y = MaxTemp, color = Year)) +
geom_point(size = 3) +
geom_smooth(method = "lm", color = "black", linetype = "dashed") +
labs(
x = "Minimum Sicaklik",
y = "Maksimum Sicaklik",
title = "Sicaklik Karsilastirma Grafigi"
) +
theme_minimal()
print(MinMaxTemp)
# Minimum ve Maksimum degerlerinin birbiriyle iliskili sekilde nasil degistigini gosteren grafigimiz
# lineer bir goruntu goruyroz. korelasyonlarimiz da fazla ve arti derecede cikmasini bekliyoruz
# ayni zamanda linear model cizgisini de cizdirip goruntuluyoruz
plot(AlburyWeather$Temp3pm~AlburyWeather$Rainfall,col = AlburyWeather$Color, pch = 19,
xlab = "Rainfall", ylab = "Sicaklik (saat3)", main ="Sicaklik Karsilastirma Grafigi")
# verilerimizde bulunan ayriki degerler sebebiyle grafigimiz kotu bir sekilde cikti bu yuzden bir alt satirda bu
# aykiri degerlerden kurtulup o sekilde tekrardan cizelim
library(tidyverse)
rainVStemp3 <- AlburyWeather %>% select(Rainfall,MinTemp,Year,Color) %>% filter(Rainfall<60)
plot(rainVStemp3$MinTemp~rainVStemp3$Rainfall,col = AlburyWeather$Color, pch = 19,
xlab = "Rainfall", ylab = "Sicaklik (saat3)", main ="Sicaklik/Yagis Miktari Grafigi")
# aralarindaki iliskiyi simdi daha guzel bir sekilde gorebiliyoruz
library(gifski)
library(ggplot2)
library(gganimate)
p <- ggplot(AlburyWeather, aes(x = as.Date(Date), y = MaxTemp, color = Year)) +
geom_line() +
theme_minimal() +
labs(title = "Yillara Göre Maksimum Sicaklik", x = "Tarih", y = "Maksimum Sicaklik")
animated_plot <- p + transition_time(as.numeric(Year)) +
labs(title = 'Yıl: {frame_time}')
animate(animated_plot)
anim_save("max_temp_animation.gif", animation = animated_plot)
print(tempHumi)
tempHumi <- ggplot(AlburyWeather, aes(x = Temp3pm, y = Humidity3pm, color = Year)) +
geom_point(size = 3) +  # Noktaları gösterir
geom_smooth(method = "lm", color = "black", linetype = "dashed") +  # Regresyon doğrusunu ekler
labs(
x = "Sicaklik (Saat 3)",
y = "Nem Orani",
title = "Sicaklik/Nem Karsilastirmasi"
) +
theme_minimal()  # Temayı sadeleştirir
print(tempHumi)
# her bir ayın saat 3 oldugundaki sicaklik degerlerinin dagilisini kontrol edelim
AlburyWeather %>% group_by(YearMonth) %>% summarise(shapiro.test(Temp3pm)$p.value)
AlburyWeather$Year <- format(as.Date(AlburyWeather$Date), "%Y")
AlburyWeather$Month <- format(as.Date(AlburyWeather$Date), "%m")
AlburyWeather$YearMonth <- format(as.Date(AlburyWeather$Date), "%Y-%m")
# aylara gore olan degisimin de grafiklerini hareketli hazirlamak icin bu sekilde ayirma islemleri gerceklestirdim.
pAy <- ggplot(AlburyWeather, aes(x = Date, y = MaxTemp, color = YearMonth)) +
geom_line() +
theme_minimal() +
labs(title = "Aylara Göre Maksimum Sıcaklık", x = "Tarih", y = "Maksimum Sıcaklık",
theme(
legend.position = "right",
legend.text = element_text(size = 8),
legend.title = element_text(size = 10),
legend.key.size = unit(0.5, "cm")))
animated_plotAy <- pAy + transition_time(as.numeric(factor(YearMonth)))
tempHumi <- ggplot(AlburyWeather, aes(x = Temp3pm, y = Humidity3pm, color = Year)) +
geom_point(size = 3) +  # Noktaları gösterir
geom_smooth(method = "lm", color = "black", linetype = "dashed") +  # Regresyon doğrusunu ekler
labs(
x = "Sicaklik (Saat 3)",
y = "Nem Orani",
title = "Sicaklik/Nem Karsilastirmasi"
) +
theme_minimal()  # Temayı sadeleştirir
print(tempHumi)
# her bir ayın saat 3 oldugundaki sicaklik degerlerinin dagilisini kontrol edelim
AlburyWeather %>% group_by(YearMonth) %>% summarise(shapiro.test(Temp3pm)$p.value)
t.test(AlburyWeather$Temp3pm[AlburyWeather$Year==2009],mu = 20,alternative = "two.sided",conf.level = 0.95)
bartlett.test(Temp3pm~Year, data = AlburyWeather[AlburyWeather$Year==c(2009,2010),])
```{r echo=TRUE}
yil9 <- AlburyWeather[AlburyWeather$Year==2009,]
yil9 <- AlburyWeather[AlburyWeather$Year==2009,]
yil10 <- AlburyWeather[AlburyWeather$Year==2010,]
t.test(x = yil9$Temp3pm ,y = yil10$Temp3pm, alternative = "two.sided")
bartlett.test(Temp3pm~Year, data = AlburyWeather[AlburyWeather$Year==c(2011,2012),])
yil11 <- AlburyWeather[AlburyWeather$Year==2011,]
yil12 <- AlburyWeather[AlburyWeather$Year==2012,]
t.test(x = yil11$Temp3pm, y = yil12$Temp3pm, alternative = "two.sided")
View(AlburyWeather)
alb <- AlburyWeather %>% filter(Year!=2008)
anova_result <- aov(Temp3pm ~ Year, data = alb)
summary(anova_result)
TukeyHSD(anova_result)
head(AlburyWeather)
# makina ogrenmesi modeli olusturmak icin hani degiskenleri kullanmam gerektigi konusunda ufak goz gezdirmeler yapiyorum
library(tidyverse)
dataModel <- AlburyWeather %>% select(Temp3pm,MinTemp,MaxTemp,Rainfall,WindSpeed3pm,Humidity3pm)
# bu verileri kullanmaya karar verdim. bu verileri kullanmama karar vermemde yukarida grafigini cizdigim kolerasyon istatistigi yardimci oldu
head(dataModel)
set.seed(125)
ind <- sample(1:nrow(dataModel), size = nrow(dataModel)*0.75)
# verilerimin %75'ini modelimi egitmek icin %25'ini modelimi test etmek icin kullanacagim
trainSet <- dataModel[ind,]
testSet <- dataModel[-ind,]
# Linear Model
modelLM <- lm(Temp3pm ~ . , data = trainSet)
summary(modelLM)
## tahmin islemini gerceklestirelim
tahminLM <- predict(modelLM,testSet)
head(tahminLM)
R2(tahminLM,testSet$Temp3pm)
# modelimizi degerlendirelim
library(caret)
R2(tahminLM,testSet$Temp3pm)
RMSE(tahminLM,testSet$Temp3pm)
MAE(tahminLM,testSet$Temp3pm)
library(earth)
modelMARS <- earth(Temp3pm ~ . , data = trainSet, penalty = 2, degree=2, nk=200,
nfold=10, keepxy=T)
summary(modelMARS)
tahminMARS <- predict(modelMARS,testSet)
head(tahminMARS)
# modelimizi degerlendirelim
library(caret)
R2(tahminMARS,testSet$Temp3pm)
RMSE(tahminMARS,testSet$Temp3pm)
```{r}
MAE(tahminMARS,testSet$Temp3pm)
# dplyr paketini aktif hale getirelim
library(tidyverse)
# Sadece tek bir konum icin analiz yapalim
AlburyWeather <- weatherAUS %>% filter(Location=="Albury")
View(AlburyWeather)
# Analiz ve tahmin icin gerekli verilerimizi seciyoruz
AlburyWeather <- AlburyWeather %>% select(Temp3pm,MinTemp,MaxTemp,Rainfall,WindSpeed3pm,Humidity3pm,Pressure3pm,Date)
AlburyWeather
head(AlburyWeather)
# Eksik veri kontrolu yapalim
library(mice)
md.pattern(AlburyWeather)
which(is.na(AlburyWeather))
#Birinci Yontem
index <- which(is.na(AlburyWeather))
AlburyWeather[-index,]
# Ikinci Yontem
na.omit(AlburyWeather)
# Bu yontemi kullanarak NA iceren tum satiri atiyoruz. Bu yontemi kullanalim
AlburyWeather <- na.omit(AlburyWeather)
head(AlburyWeather)
AlburyWeather$Year <- format(as.Date(AlburyWeather$Date, format="%Y-%m-%d"), "%Y")
# Veri setimizdeki tarih bolumune ek olarak Yil bolumu olusturduk
years <- unique(AlburyWeather$Year)
# Her bir yili tekil olarak ayarladik
colors <- rainbow(length(years))
# Her tekil yila renk atamasi yaptik
AlburyWeather$Color <- colors[as.factor(AlburyWeather$Year)]
# faktorlere gore renk atamasi yaptik
AlburyWeather$Date <- as.Date(AlburyWeather$Date, format="%Y-%m-%d")
havadurumu <- ggplot(AlburyWeather, aes(x = Date, y = Temp3pm, color = Year)) +
geom_point(size = 3) +
labs(
title = "Tarihlere Gore Hava Durumu",
x = "Tarih",
y = "Hava Sicakligi (Saat 3)"
) + theme_minimal() +
theme(
legend.title = element_blank(),
legend.text = element_text(size = 8),
legend.key.size = unit(0.5, "cm")
)
print(havadurumu)
plot(y=AlburyWeather$Temp3pm,x=AlburyWeather$Year, main =  "Tarihlere Gore Hava Durumu",
ylab = "Hava Sicakligi(Saat 3)",xlab = "Tarih",col = AlburyWeather$Color, pch = 19)
library(GGally)
# Albury sehrine ait verileri aciklayici olarak gorsellestiren bir fonksiyonumuz:
ggpairs(AlburyWeather,columns = 1:7)
MinMaxTemp <- ggplot(AlburyWeather, aes(x = MinTemp, y = MaxTemp, color = Year)) +
geom_point(size = 3) +
geom_smooth(method = "lm", color = "black", linetype = "dashed") +
labs(
x = "Minimum Sicaklik",
y = "Maksimum Sicaklik",
title = "Sicaklik Karsilastirma Grafigi"
) +
theme_minimal()
print(MinMaxTemp)
plot(AlburyWeather$Temp3pm~AlburyWeather$Rainfall,col = AlburyWeather$Color, pch = 19,
xlab = "Rainfall", ylab = "Sicaklik (saat3)", main ="Sicaklik Karsilastirma Grafigi")
library(tidyverse)
rainVStemp3 <- AlburyWeather %>% select(Rainfall,MinTemp,Year,Color) %>% filter(Rainfall<60)
plot(rainVStemp3$MinTemp~rainVStemp3$Rainfall,col = AlburyWeather$Color, pch = 19,
xlab = "Rainfall", ylab = "Sicaklik (saat3)", main ="Sicaklik/Yagis Miktari Grafigi")
library(gifski)
library(ggplot2)
library(gganimate)
p <- ggplot(AlburyWeather, aes(x = as.Date(Date), y = MaxTemp, color = Year)) +
geom_line() +
theme_minimal() +
labs(title = "Yillara Göre Maksimum Sicaklik", x = "Tarih", y = "Maksimum Sicaklik")
animated_plot <- p + transition_time(as.numeric(Year)) +
labs(title = 'Yıl: {frame_time}')
AlburyWeather$Year <- format(as.Date(AlburyWeather$Date), "%Y")
AlburyWeather$Month <- format(as.Date(AlburyWeather$Date), "%m")
AlburyWeather$YearMonth <- format(as.Date(AlburyWeather$Date), "%Y-%m")
# aylara gore olan degisimin de grafiklerini hareketli hazirlamak icin bu sekilde ayirma islemleri gerceklestirdim.
pAy <- ggplot(AlburyWeather, aes(x = Date, y = MaxTemp, color = YearMonth)) +
geom_line() +
theme_minimal() +
labs(title = "Aylara Göre Maksimum Sıcaklık", x = "Tarih", y = "Maksimum Sıcaklık",
theme(
legend.position = "right",
legend.text = element_text(size = 8),
legend.title = element_text(size = 10),
legend.key.size = unit(0.5, "cm")))
animated_plotAy <- pAy + transition_time(as.numeric(factor(YearMonth)))
tempHumi <- ggplot(AlburyWeather, aes(x = Temp3pm, y = Humidity3pm, color = Year)) +
geom_point(size = 3) +  # Noktaları gösterir
geom_smooth(method = "lm", color = "black", linetype = "dashed") +  # Regresyon doğrusunu ekler
labs(
x = "Sicaklik (Saat 3)",
y = "Nem Orani",
title = "Sicaklik/Nem Karsilastirmasi"
) +
theme_minimal()  # Temayı sadeleştirir
print(tempHumi)
# her bir ayın saat 3 oldugundaki sicaklik degerlerinin dagilisini kontrol edelim
AlburyWeather %>% group_by(YearMonth) %>% summarise(shapiro.test(Temp3pm)$p.value)
t.test(AlburyWeather$Temp3pm[AlburyWeather$Year==2009],mu = 20,alternative = "two.sided",conf.level = 0.95)
bartlett.test(Temp3pm~Year, data = AlburyWeather[AlburyWeather$Year==c(2009,2010),])
yil9 <- AlburyWeather[AlburyWeather$Year==2009,]
yil10 <- AlburyWeather[AlburyWeather$Year==2010,]
t.test(x = yil9$Temp3pm ,y = yil10$Temp3pm, alternative = "two.sided")
bartlett.test(Temp3pm~Year, data = AlburyWeather[AlburyWeather$Year==c(2011,2012),])
yil11 <- AlburyWeather[AlburyWeather$Year==2011,]
yil12 <- AlburyWeather[AlburyWeather$Year==2012,]
t.test(x = yil11$Temp3pm, y = yil12$Temp3pm, alternative = "two.sided")
# elimizdeki 2008 veri sayisi az oldugundan anova testi oncesi onu cikaralim
library(tidyverse)
alb <- AlburyWeather %>% filter(Year!=2008)
anova_result <- aov(Temp3pm ~ Year, data = alb)
summary(anova_result)
TukeyHSD(anova_result)
head(AlburyWeather)
dataModel <- AlburyWeather %>% select(Temp3pm,MinTemp,MaxTemp,Rainfall,WindSpeed3pm,Humidity3pm)
# bu verileri kullanmaya karar verdim. bu verileri kullanmama karar vermemde yukarida grafigini cizdigim kolerasyon istatistigi yardimci oldu
head(dataModel)
set.seed(125)
ind <- sample(1:nrow(dataModel), size = nrow(dataModel)*0.75)
# verilerimin %75'ini modelimi egitmek icin %25'ini modelimi test etmek icin kullanacagim
trainSet <- dataModel[ind,]
testSet <- dataModel[-ind,]
# Linear Model
modelLM <- lm(Temp3pm ~ . , data = trainSet)
summary(modelLM)
## tahmin islemini gerceklestirelim
tahminLM <- predict(modelLM,testSet)
head(tahminLM)
# modelimizi degerlendirelim
library(caret)
R2(tahminLM,testSet$Temp3pm)
RMSE(tahminLM,testSet$Temp3pm)
MAE(tahminLM,testSet$Temp3pm)
library(earth)
modelMARS <- earth(Temp3pm ~ . , data = trainSet, penalty = 2, degree=2, nk=200,
nfold=10, keepxy=T)
summary(modelMARS)
tahminMARS <- predict(modelMARS,testSet)
head(tahminMARS)
# modelimizi degerlendirelim
library(caret)
R2(tahminMARS,testSet$Temp3pm)
RMSE(tahminMARS,testSet$Temp3pm)
MAE(tahminMARS,testSet$Temp3pm)
setwd()
getwd()
setwd("C:\Users\halil ibrahim kaya\Documents\GitHub\R-Project\weaterAUS\dataset")
read.csv(file = "C:\Users\halil ibrahim kaya\Documents\GitHub\R-Project\weaterAUS\dataset\weatherAUS.csv", header = T)
read.csv(file = "C:/Users/halil ibrahim kaya/Documents/GitHub/R-Project/weaterAUS/dataset/weatherAUS.csv", header = TRUE)
head(AlburyWeather)
